-------------------------------------------- SCREEN 000
(                        < 7/20/83>140) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 001
(                        < 7/20/83>141) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 002
( ADD FPA TO VIRT. SYS.  < 7/20/83>142) 
                                        
VIRTUAL FPA-RWTS @ FORTH 0 32000 U/MOD  
SWAP DROP 3 + ONB LOAD                  
                                        
( SKIPS NEXT SCREEN IF DECOMPILE AND  ) 
( TRANSLATE ARE ALREADY IN DICTIONARY ) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 13:25) 
-------------------------------------------- SCREEN 003
( INSTALL FPA ON VIRT.   < 7/20/83>143) 
                                        
: DECOMPILE GET-FPA [ 77 ] LITERAL      
   EXECUTE ;                            
                                        
: TRANSLATE GET-FPA [ 77 ] LITERAL      
   EXECUTE ;                            
-->                                     
                                        
( THE 77 IS DUMMY NUMBER THAT WILL BE ) 
( REPLACED WITH THE CFA OF THE WORDS  ) 
( IN THE FPA.                         ) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 13:25) 
-------------------------------------------- SCREEN 004
( ADD FPA TO VIRT. SYS.  < 7/20/83>144) 
                                        
   DECIMAL FORGET-SYS                   
   FREEZE VIRTUAL                       
   SECS/TRK TRKS/HD * 1- A&E-SECTS -    
   UTIL-SECTS - NEXT-SECTOR !           
   35 ' FPA-SECTS !                     
   VIR-BASE DP !                        
                                        
   VIR-TST FORTH CONSTANT VIR-CHK       
   VIRTUAL LATEST PFA-LFA               
   ' FPA-FIRSTLFA  ! FORTH CR CR        
                                        
  10 ONB LOAD LOADTRANSLATOR            
   ADDDECOMPILER                        
                                        
 ' DECOMPILE CFA                        
 ' TRANSLATE CFA                        
-->                                     
                                        
                                        
                                        
                                        
                               ( 13:25) 
-------------------------------------------- SCREEN 005
( INSTALL FPA            < 7/20/83>145) 
                                        
   VIRTUAL                              
                                        
   LATEST PFA-LFA ' FPA-LASTLFA !       
   ( SAVE LFA OF LAST WORD IN FPA)      
                                        
   FORTH                                
                                        
   ICEBOX @ VOC-LINK !                  
 ( REMOVE ANY ADDED VOC FROM VOC-LINK ) 
                                        
   ICEBOX 2+ @ DP !                     
   ( RESTORE PRIOF  DP )                
                                        
   ICEBOX 4 + @ CONTEXT @ ! DEFINITIONS 
   ( RESTORE PRIOR LATESTLFA )          
                                        
                -->                     
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 006
( INSTALL FPA            < 7/20/83>146) 
                                        
                                        
   FORGET-SYS VIRTUAL 4 SYS-FLG !       
                                        
   SYS-LINK1  FPA-FIRSTLFA ! FPA-LASTLFA
   SYS-LINK2 !                          
                                        
   FORTH                                
   ( THE WORDS DECOMPILE, TRANSLATE, )  
   ( OR GET-FPA WILL CALL UP FPA )      
                                        
  ' TRANSLATE 4 + !                     
  ' DECOMPILE 4 + !                     
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 007
( INSTALL FPA            < 7/20/83>147) 
                                        
   VIRTUAL                              
                                        
   FPA-RWTS VIR-BASE OVER !             
   ( ADDR           )                   
                                        
   6 OVER 2+ !                          
   ( SLOT 6 ALWAYS   )                  
                                        
   NEXT-SECTOR @ FPA-SECTS - DUP        
   NEXT-SECTOR ! ( UPDATE NEXT-SEC )    
                                        
   1+ SECS/TRK /MOD 0 4 PICK 4 + !      
        ( DRV 0  )                      
                                        
   3 PICK 8 + ! OVER 6 + !              
   ( TRK & SEC )                        
                                        
   @RWTS-PARAM 0 FPA-SECTS RWTS         
   ( SAVE FPA TO DISK )                 
                                        
  SAVE-FORTH                            
-->                            ( 10:12) 
-------------------------------------------- SCREEN 008
( INSTALL FPA       <CONC< 7/20/83>148) 
                                        
CR CR                                   
." FPA HAS BEEN INSTALLED AS A VIRTUAL" 
CR ." SUBSYSTEM ON YOUR MVP-FORTH" CR   
." VIRTUAL SYSTEM DISK."      CR CR     
." NOW, EITHER DECOMPILE WORDS<S>," CR  
." TRANSLATE WORDS<S>, OR GET-FPA" CR   
." WILL CALL THE SUBSYSTEM"             
CR                                      
." TO BANK-SWITCHED MEMORY." CR CR      
                                        
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
-------------------------------------------- SCREEN 009
( -->                   << 7/20/83>149) 
                                        
: --> ?LOADING 0 >IN ! 1 BLK +!         
    BLK @ . ;   IMMEDIATE               
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 010
( MANDATORY 1ST LOAD '82<< 5/ 2/85>150) 
FORTH DEFINITIONS DECIMAL               
: TRANSLATOR  ;  : HOME PAGE ;          
                                        
                                        
( NO. IS 1ST SCRN NO. )                 
: +FPA0 ONB 10 + ;                      
     1 CONSTANT RELBRANCH               
     1 CONSTANT HASTERMINATORS          
: COPYRIGHT ;                           
-->                                     
                                        
: COPYRIGHT  CR CR                      
   ." COPYRIGHT 1981, 1982"             
   CR ." BY T. E. WEMPE "               
   ." AND R. E. CURRY"                  
   CR CR ." ALL RIGHTS RESERVED." CR    
   ." REPRODUCTIONS IN ANY FORM MUST BE"
   CR                                   
   ." AUTHORIZED IN WRITING BY THE AUTH"
   ." ORS." CR CR ;  -->                
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 011
( LOAD&ADD MODULES 1982 << 5/ 2/85>151) 
                                        
: VER. ;                                
                                        
: LOADTRANSLATOR  HOME VER. COPYRIGHT   
   ." LOADING TRANSLATOR" CR CR         
   6 +FPA0 LOAD HASTERMINATORS          
     IF 11 +FPA0 LOAD                   
     ELSE 12 +FPA0 LOAD                 
     THEN 15 +FPA0 LOAD ;               
                                        
( next word needs translator )          
: ADDCALLFINDER  HOME VER. COPYRIGHT    
   ." LOADING CALLFINDER" CR CR         
   30 +FPA0 LOAD ;                      
-->                                     
                                        
: VER.                                  
  ." FPA VERSION: APPLE II/IIE PADS 2.0 
   CR CR ;                              
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 012
( BLANK SCREEN          << 7/20/83>152) 
-->                                     
                                        
THIS VERSION OF FPA HAS BEEN MODIFIED TO
CONFORM WITH THE LFA UP FRONT AND LFA TO
LFA LINKING.                            
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 013
( ESTABLISH BRANCH MODE << 5/ 2/85>153) 
                                        
: TST IF THEN ;                         
: FINDMODE                              
   ' TST 2+ @ 2 =                       
   IF 1 ' RELBRANCH !                   
   ELSE ' TST 2+ @ ' TST 4 + =          
     IF 0 ' RELBRANCH !                 
     ELSE CR ." UNKN BRNCH MODE"        
      7 EMIT QUIT                       
   THEN THEN ;                          
                                        
FINDMODE FORGET TST                     
                                        
: ADDDECOMPILER                         
   HOME VER. COPYRIGHT                  
   ." LOADING DECOMPILER" CR CR         
   46 +FPA0 LOAD RELBRANCH              
   IF 70 +FPA0 LOAD                     
   ELSE 69 +FPA0 LOAD                   
   THEN 71 +FPA0 LOAD CR ;              
-->                                     
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 014
( ADD MODULES           << 5/ 2/85>154) 
                                        
   0000 CONSTANT NULL                   
-->                                     
                                        
: ADDSUBRDECOMPILER                     
   HOME VER. COPYRIGHT                  
   ." LOADING SUBRDECOMPILER" CR CR     
   94 +FPA0 LOAD ;                      
                                        
: LOADALL  LOADTRANSLATOR               
   ADDCALLFINDER ADDDECOMPILER          
   ADDSUBRDECOMPILER ;                  
      0000 CONSTANT NULL                
-->                                     
: EXITTEST  114 +FPA0 LOAD ;            
                                        
: NA.                                   
   BEGIN 1+ DUP C@ DUP 127 AND EMIT     
    128 AND                             
   UNTIL DROP 32 EMIT ; -->             
( EXITTEST NOT NEEDED FOR PADS )        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 015
( ESTABLISH NULL ADDR   << 7/20/83>155) 
                                        
: MATCHPAD PAD LATEST 1 <<FIND> ;       
                                        
: FINDNULL  PAD 3 0 FILL                
   MATCHPAD                             
   IF DROP ' NULL !                     
   ELSE CR                              
      ." CANNOT FIND NULL ADDRESS"      
      CR ." READ APPENDIX A.8 NOW!"     
   THEN ;                               
                                        
FINDNULL   FORGET MATCHPAD              
                                        
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 016
( BLANK SCREEN          << 7/20/83>156) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 017
( CFA EQUATES           << 5/ 9/85>157) 
: DUNCE  CREATE  DOES> ;                
: DUMMY  CREATE  DOES> ;                
  DUMMY  DOEZ                           
  VARIABLE MISC                         
                                        
' DUMMY    CFA @  CONSTANT COLON        
' DOES>    CFA    CONSTANT DOES         
' <EXIT>   CFA    CONSTANT ENDCOLON     
' BRANCH   CFA    CONSTANT BRA          
' 0BRANCH  CFA    CONSTANT 0BRA         
' <LOOP>   CFA    CONSTANT <LOO         
' <+LOOP>  CFA    CONSTANT <+LOO        
' </LOOP>  CFA    CONSTANT </LOO        
' <ABORT"> CFA    CONSTANT <AB"         
' LIT      CFA    CONSTANT LITT         
' <;CODE>  CFA    CONSTANT COLONCODE    
' COMPILE  CFA    CONSTANT COMPL        
' <.">     CFA    CONSTANT <."          
' MISC     CFA @  CONSTANT VARIABL      
' VARIABL  CFA @  CONSTANT CONSTNT      
                                        
-->                                     
                               ( WHO? ) 
-------------------------------------------- SCREEN 018
( CFA EQUATES & VAR'S   << 5/ 9/85>158) 
                                        
0 CONSTANT DJB                          
0 CONSTANT DOESCODE                     
0 CONSTANT ABSDOESJMP                   
                                        
 VARIABLE COMPILENEXT                   
 VARIABLE COMPILEAFTER                  
                                        
 VARIABLE WORDA                         
 VARIABLE WORDB                         
 VARIABLE WORDTEST                      
 VARIABLE UPLIM                         
                                        
 VARIABLE LLENGTH     38 LLENGTH !      
 VARIABLE MARGIN       3 MARGIN !       
 VARIABLE LCOUNT       0 LCOUNT !       
 VARIABLE ENDTYPE                       
 VARIABLE MARGINADJ    0 MARGINADJ !    
 VARIABLE FIRSTINDENT  3 FIRSTINDENT !  
                                        
-->                                     
                                        
                               ( WHO? ) 
-------------------------------------------- SCREEN 019
( TRANSLATOR            << 5/ 9/85>159) 
                                        
( ADDR ---, NFA )                       
: NFAABOVE                              
   [COMPILE] APPENDIX                   
   2- UPLIM @ 2-                        
   BEGIN DUP @ 3 PICK 2 PICK U<         
   WHILE SWAP DROP                      
   REPEAT DROP SWAP DROP 2+             
   [COMPILE] MAIN ;                     
                                        
: SETUPLIM                              
   [COMPILE] APPENDIX                   
   LATEST UPLIM !                       
   [COMPILE] MAIN                       
   WORDB @ NFAABOVE UPLIM ! ;           
                                        
( A B N ---, N A B 0 )                  
: PLACEN  ROT ROT 0 ;                   
-->                                     
                                        
                                        
                                        
                               ( WHO? ) 
-------------------------------------------- SCREEN 020
( MVP MOD               << 5/ 2/85>160) 
                                        
: <DODOES-JSR> ;                        
' <DODOES-JSR> CFA CONSTANT "DODOES     
                                        
: DOESTYPE ' DOEZ LFA 4 - DUP ' DUMMY   
   4 + - ' DJB ! DUP @ ' DUMMY LFA      
   4 - DUP @ DUP 4 PICK =               
    IF 1 ' ABSDOESJMP ! ' DOESCODE !    
     DROP DROP DROP                     
    ELSE + 2+ 3 ROLL 3 ROLL + 2+ OVER = 
     IF 0 ' ABSDOESJMP ! ' DOESCODE !   
     ELSE 7 EMIT CR ." CAN'T IDENT "    
      ." DOES JUMP" CR DROP             
     THEN THEN ;                        
                                        
DOESTYPE FORGET DOESTYPE                
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 021
( HAVE ALL EXITS VERSION<< 7/20/83>161) 
                                        
( TURN OFF NOT ALL EXITS VERSION )      
: NOEXIT?  ;                            
                                        
: ADDEXIT  ;                            
                                        
( TURN ON HAVE ALL EXITS VERSION )      
: HAVEXIT  + DUP @ ;                    
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 022
( NOT ALL EXITS VERSION << 7/20/83>162) 
 VARIABLE PFINDEX   VARIABLE NOEXIT     
: HAVEXIT  ; ( TURNS OFF OTHER VERSION )
: SETSTORE  VARIABLE HERE 2 - ;         
: STOREBYTES [COMPILE] ' , ,            
   1 OVER +! ;  SETSTORE PFBYTES        
77 STOREBYTES ABORT                     
66 STOREBYTES INTERPRET                 
36 STOREBYTES QUIT                      
                                        
                                        
                                        
                                        
DROP -->                                
( SAMPLE LIST OF WORDS OFTEN WITHOUT )  
( ENDING EXITS                       )  
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 023
( NOT ALL EXITS VERSION << 7/20/83>163) 
                                        
( N<J> PF<I> ---, PF<J> PF <J>@ )       
: NOEXIT? NOEXIT @                      
   IF OVER PFINDEX +! + DUP @           
    PFBYTES 2 - PFBYTES @ 0             
    DO 4 + DUP @ WORDTEST @ =           
     IF 2+ @ PFINDEX @ =                
      IF DROP 2 - ENDCOLON 0 ELSE 0 THEN
      LEAVE                             
     THEN                               
    LOOP DROP                           
   ELSE + DUP @                         
   THEN ;                               
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 024
( NOT ALL EXITS VERSION << 7/20/83>164) 
                                        
( PFA 0 ---, 0 PFA )                    
: ADDEXIT  SWAP 0 NOEXIT ! PFBYTES 2 -  
   PFBYTES @ 0                          
   DO 4 + DUP @ WORDTEST @ =            
    IF 1 NOEXIT ! 0 PFINDEX ! LEAVE THEN
   LOOP DROP ;                          
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 025
( BLANK SCREEN          << 7/20/83>165) 
                                        
: DOESCODE?  ABSDOESJMP                 
   IF @ ELSE DUP @ + 2+ THEN            
   DOESCODE = ;                         
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 026
( COLON PARSER          << 5/ 9/85>166) 
                                        
( N<F> PF<I> ---, N<K> PF<J> PF<J>@ F ) 
: COLON-CALL                            
   0 ENDTYPE ! HAVEXIT NOEXIT?          
   COMPILENEXT @                        
      IF 0 COMPILENEXT ! 2 PLACEN       
      ELSE                              
   DUP COMPL =                          
      IF 1 COMPILENEXT ! 2 PLACEN       
      ELSE                              
         0 COMPILENEXT !                
   DUP ENDCOLON =                       
      IF 1 ENDTYPE ! 2 PLACEN DROP 1    
      ELSE                              
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
-------------------------------------------- SCREEN 027
( COLON PARSER CONCLD   << 5/ 9/85>167) 
                                        
   DUP COLONCODE =                      
      IF OVER 2+ DJB + DOESCODE?        
         IF 3 ENDTYPE !                 
            4 DJB + PLACEN              
         ELSE 2 ENDTYPE !               
            2 PLACEN DROP 1             
         THEN                           
      ELSE                              
   DUP 0BRA =       OVER BRA = OR       
    OVER <LOO = OR   OVER <+LOO = OR    
     OVER </LOO = OR  OVER LITT = OR    
      IF 4 PLACEN                       
      ELSE                              
   DUP <." =  OVER <AB" = OR            
      IF OVER 2+ C@                     
         3 + PLACEN                     
      ELSE                              
         2 PLACEN                       
  THEN THEN THEN THEN THEN THEN ;       
-->                                     
                                        
                               ( WHO? ) 
-------------------------------------------- SCREEN 028
( BLANK SCREEN          << 7/20/83>168) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 029
( TRANSLATOR            << 5/ 2/85>169) 
  VARIABLE ENDOFPF                      
                                        
: BELL    7 EMIT ;                      
: 2BELLS  BELL BELL ;                   
                                        
: ENDOFPF+ ( PFA ---, )                 
   0 ADDEXIT 0                          
   BEGIN DROP COLON-CALL UNTIL          
   DROP + ENDOFPF ! ;                   
                                        
: NEXTLINE                              
   CR 0 OUT ! MARGIN @                  
   MARGINADJ @ + SPACES 0 MARGINADJ !   
   1 LCOUNT +! ;                        
                                        
: ENDLINE? ( COUNT ---, )               
   OUT @ + LLENGTH @ >                  
   IF NEXTLINE THEN ;                   
                                        
: PRINTID ( CFA ---, )                  
   2+ NFA DUP C@ 31 AND                 
   ENDLINE? ID. ;                       
-->                            (  RLP ) 
-------------------------------------------- SCREEN 030
( TRANSLATOR            << 5/ 2/85>170) 
                                        
( SET ADDRS? TO 1 FOR ADDR PRINTOUTS )  
   VARIABLE ADDRS? 0 ADDRS? !           
                                        
( PFA ---, )                            
: TRANSLCOLON                           
   0 COMPILENEXT !                      
   0 COMPILEAFTER !                     
   0 ADDEXIT                            
   BEGIN                                
      COLON-CALL ADDRS? @               
      IF 7 ENDLINE? 3 PICK ." ("        
         3 U.R ." )"                    
      THEN                              
      SWAP DUP PRINTID ENDTYPE @ 3 =    
      IF "DODOES PRINTID DROP           
-->                                     
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 031
( TRANSLATOR            << 5/ 2/85>171) 
                                        
      ELSE                              
         DUP <." = SWAP <AB" = OR       
         COMPILEAFTER @ 0= AND          
         IF 2 PICK 2+ DUP C@ DUP 8 +    
            ENDLINE? . COUNT TYPE SPACE 
         ELSE 3 PICK 2-                 
            IF 2 PICK 2+ 5 ENDLINE?     
               @ 12000 OVER ABS <       
               IF U. ELSE . THEN        
            THEN                        
         THEN                           
      THEN                              
      COMPILENEXT @                     
      COMPILEAFTER !                    
   UNTIL DDROP ;                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 032
( TRANSLATOR            << 5/ 2/85>172) 
                                        
( PFA ---, )                            
: IMMED?                                
   NFA C@ 64 AND                        
   IF 13 ENDLINE?                       
      ."   IMMEDIATE"                   
   THEN ;                               
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 033
( TRANSLATOR            << 5/ 2/85>173) 
                                        
( PFA NFA ---, )                        
: WORDTYPE                              
   FIRSTINDENT @ MARGIN ! CR 0 OUT !    
   OVER CFA @ COLON =                   
   IF ." : " ID. SPACE TRANSLCOLON      
   ELSE ID.                             
      DUP DUP CFA @ =                   
      IF ." --ASSEMBLY CODE " DROP      
      ELSE CFA @                        
         DUP VARIABL =                  
            IF ." --VARIABLE" DROP      
         ELSE DUP CONSTNT =             
            IF ." --CONSTANT" DROP      
         ELSE DJB + DUP DOESCODE?       
            IF ." --DOES CALL TO: "     
               NFAABOVE 2- @ 2+ ID.     
            ELSE ." --OTHER" DROP       
         THEN THEN THEN                 
   THEN THEN ;                          
                                        
-->                                     
                                        
-------------------------------------------- SCREEN 034
( NOWRDS?               << 5/ 2/85>174) 
                                        
( PFA ---, )                            
: TRANSL                                
   DUP DUP NFA WORDTYPE IMMED?          
   NEXTLINE ;                           
                                        
: NOWORDS? ( F ---, )                   
   0=                                   
   IF BELL CR ." WORD(S)"               
      QUIT                              
   THEN ;                               
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 035
( TRANSLATOR            << 5/ 2/85>175) 
( --- <>OR WORD<S>, F : F=0,1,2 WRDS )  
: WORDSAB                               
   [COMPILE] ' [COMPILE] '              
   OVER NULL = OVER NULL = AND          
   IF DDROP 0                           
   ELSE                                 
      DUP NULL =                        
      IF DROP DUP WORDA ! WORDB ! 1     
      ELSE                              
         DDUP U<                        
         IF WORDB ! WORDA !             
         ELSE WORDA ! WORDB !           
         THEN 2                         
      THEN                              
   THEN ;                               
                                        
: NEXTWORD                              
   WORDTEST @ DUP NFA UPLIM !           
   LFA @ 2+ PFA WORDTEST ! ;            
-->                                     
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 036
( TRANSLATOR            << 5/ 2/85>176) 
                                        
: HEAD2                                 
   CR CR WORDB @ DUP NFA ID.            
   ." THRU " WORDA @ NFA ID. CR CR      
   WORDTEST ! ;                         
                                        
: CONT/QUIT? ( ---, F )                 
   ?TERMINAL                            
   IF ( KEY DROP )                      
      BEGIN CR                          
         ." ( C=CONT; Q=QUIT)" 1        
         LCOUNT +! KEY DUP 67 =         
         IF DROP 0 1                    
         ELSE 81 =                      
            IF 1 1                      
               ELSE 0                   
         THEN THEN                      
      UNTIL                             
   ELSE 0 THEN ;                        
-->                                     
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 037
( BLANK SCREEN          << 7/20/83>177) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 038
( TRANSLATOR            << 5/ 2/85>178) 
                                        
( ---, WORD<S> )                        
: TRANSLATE                             
   WORDSAB NOWORDS? HOME                
   SETUPLIM ." TRANSLATING:"            
   HEAD2 BASE @ MISC !                  
   BEGIN                                
      WORDTEST @ DUP NFA DUP CR         
      10 SPACES ." NFA AT "             
      HEX U. DECIMAL U.                 
      MISC @ BASE !                     
      TRANSL                            
      NEXTWORD                          
      WORDTEST @ WORDA @ U<             
      CONT/QUIT? OR                     
   UNTIL 2BELLS CR ;                    
                                        
EXIT                                    
-->                                     
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 039
( WLIST <NOT COMPILED>  << 7/20/83>179) 
( SEE NEW VLIST INSTEAD   )             
: WLIST  128 OUT ! WORDSAB DUP 0=       
   IF LATEST WORDB ! 0 WORDA ! DROP     
   ELSE 1 =   ( --- <>OR WORD<S>,  )    
     IF 0 WORDA ! ( F=0,1,2: NO.WRDS )  
     ELSE WORDA @ LFA @ 2+ WORDA !      
     THEN WORDB @ NFA WORDB !           
   THEN WORDB @                         
     BEGIN DUP C@ 32 AND 0=             
        IF DUP C@ 31 AND 4 + OUT @ +    
         LLENGTH @ >                    
           IF CR 0 OUT !                
           THEN DUP ID. SPACE SPACE     
        THEN 2- @ 2+ DUP WORDA @ =      
      CONT/QUIT? OR                     
     UNTIL DROP CR ;  EXIT              
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 040
( CALLFINDER            << 7/20/83>180) 
                                        
FORTH DEFINITIONS DECIMAL               
: CALLFINDER  ;                         
       VARIABLE CALLED?                 
     0 CONSTANT 1STPFA                  
                                        
: F1STPFA LATEST 2-                     
   BEGIN DUP @ WHILE @ REPEAT           
   2+ PFA ;                             
F1STPFA ' 1STPFA ! FORGET F1STPFA       
                                        
: CALLD  CR 3 SPACES WORDTEST @ DUP     
   CALLED? @ U<                         
     IF ."  * FORWARD "                 
     THEN ." CALLED BY: " NFA ID. ;     
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 041
( CALLFINDER            << 7/20/83>181) 
                                        
: DOESCALL?                             
   WORDTEST @ CFA @ CALLED? @           
   DUP CFA 3 PICK U< ROT ROT            
   NFAABOVE U< AND                      
     IF CR 2 SPACES ." DOES PART"       
        CALLD                           
     THEN ;                             
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
-------------------------------------------- SCREEN 042
( CALLFINDER            << 7/20/83>182) 
                                        
( PSEUDONAME IN VOCAB WORD )            
' FORTH 2+ @ CONSTANT PNAME             
                                        
: GETCALLS  WORDTEST @ 0 0 COMPILENEXT  
   ! ADDEXIT                            
     BEGIN COLON-CALL SWAP CALLED? @    
      CFA =                             
        IF CALLD                        
        THEN                            
     UNTIL DDROP ;                      
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 043
( CALLFINDER            << 7/20/83>183) 
( LFA<I> ---, LFA<J> )                  
: TESTCALLS DUP 2+ C@ 32 AND 0=         
   IF DUP 2+ PFA DUP                    
    WORDTEST ! DUP CFA @ COLON =        
      IF GETCALLS                       
      ELSE DUP CFA @ DJB + DOESCODE?    
         IF DOESCALL?                   
         THEN                           
      THEN DROP                         
   THEN @ ;                             
                                        
: ALLVOCCALLS  LATEST 2-                
   BEGIN DUP 0= NOT                     
   WHILE TESTCALLS                      
   REPEAT DROP ;  -->                   
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 044
( CALLFINDER            << 7/20/83>184) 
                                        
: ALLCALLS  VOC-LINK                    
     BEGIN @ DUP 4 - NFA CR ."  IN "    
      ID. ." VOCABULARY"                
      DUP 4 - @                         
        BEGIN DUP 2+ @ PNAME = NOT      
         OVER 0= NOT AND                
        WHILE TESTCALLS                 
        REPEAT DROP DUP @ 0=            
     UNTIL DROP ;                       
( VOCALLIM IS SEARCH UPPER LIMIT )      
( FOR FINDVOCCALLS               )      
 VARIABLE VOCALLIM                      
 ' TRANSLATOR NFA VOCALLIM !            
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 045
( BLANK SCREEN          << 7/20/83>185) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 046
( CALLFINDER            << 7/20/83>186) 
                                        
: VOCCALLS  LATEST VOCALLIM @ DUP       
   3 PICK U<                            
     IF SWAP                            
     THEN DROP CALLED? @ OVER U<        
     IF 2-                              
        BEGIN CALLED? @ 2- OVER U<      
        WHILE TESTCALLS                 
        REPEAT DROP                     
     ELSE DROP ." IS ABOVE LIMIT" THEN ;
   -->                                  
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 047
( CALLFINDER            << 7/20/83>187) 
                                        
: GETNEXT  CALLED? @ DUP NFA UPLIM !    
   LFA @ DUP                            
   IF 2+ PFA DUP CALLED? ! WORDA @ U<   
   ELSE DROP 1                          
   THEN CONT/QUIT? OR ;                 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 048
( BLANK SCREEN          << 7/20/83>188) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 049
( CALLFINDER            << 7/20/83>189) 
                                        
: CALLSETUP  WORDSAB DUP 0=             
   IF LATEST PFA WORDB ! 1STPFA         
    WORDA ! DROP                        
   ELSE 1 =                             
    IF 1STPFA WORDA ! THEN              
   THEN HOME SETUPLIM ;                 
                                        
( --- <> OR WORD<S>, )                  
: FINDALLCALLS  CALLSETUP               
   ." FINDING ALL CALLS TO:"            
   HEAD2 WORDB @ CALLED? !              
     BEGIN CALLED? @ NFA CR ID.         
      ALLCALLS GETNEXT                  
     UNTIL 2BELLS CR ; -->              
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 050
( CALLFINDER            << 7/20/83>190) 
                                        
( --- <> OR WORD<S>, )                  
: FINDALLVOCCALLS   CALLSETUP           
   ." FINDING ALL THIS VOC CALLS TO:"   
   HEAD2 WORDB @ CALLED? !              
   BEGIN CALLED? @ NFA CR ID.           
    ALLVOCCALLS GETNEXT                 
   UNTIL 2BELLS CR ;                    
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 051
( CALLFINDER            << 7/20/83>191) 
                                        
( --- <> OR WORD<S>, )                  
: FINDVOCCALLS  CALLSETUP               
   ." FINDING NORMAL CALLS, THIS VOC, T"
   ." O:" HEAD2 SETUPLIM WORDB @        
   CALLED? !                            
     BEGIN CALLED? @ NFA CR ID.         
      VOCCALLS GETNEXT                  
     UNTIL 2BELLS CR ;                  
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 052
( BLANK SCREEN          << 7/20/83>192) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 053
( CALLFINDER            << 7/20/83>193) 
                                        
( PFA ---, PFA )                        
: CALLSFWD?  DUP WORDTEST ! DUP 0       
   COMPILENEXT ! 0 ADDEXIT              
     BEGIN COLON-CALL 0=                
     WHILE OVER U< 0=                   
        IF 0 OUT ! CR 3 PICK NFA ID.    
         12 OUT @ - SPACES              
         ." CALLS FORWARD TO: " DUP @   
         2+ NFA ID.                     
        THEN                            
     REPEAT DDROP DROP ;                
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 054
( CALLFINDER            << 7/20/83>194) 
: FINDFORWARDCALLS  1 MISC ! HOME CR    
   ." FORWARD CALLS ONLY:" CR VOC-LINK  
     BEGIN @ DUP 4 - @                  
        BEGIN DUP 2+ @ PNAME = NOT      
         OVER 0= NOT AND                
        WHILE DUP 2+ C@ 32 AND 0=       
           IF 1 MISC +! DUP 2+ PFA DUP  
            CFA @ COLON =               
              IF CALLSFWD? THEN DROP    
           THEN @                       
        REPEAT DROP DUP @ 0=            
     UNTIL DROP CR CR MISC @ 2BELLS     
   ." TOTAL NO. WORDS, ALL VOCS = "     
   . CR ;  -->                          
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 055
( CALLFINDER END        << 7/20/83>195) 
                                        
: VOCNAMES  HOME ." VOCABULARIES:"      
   CR CR VOC-LINK                       
     BEGIN @ DUP                        
     WHILE DUP 4 - NFA 3 SPACES ID. CR  
      CR                                
     REPEAT DROP ;                      
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 056
( DECOMPILER START      << 7/20/83>196) 
FORTH DEFINITIONS DECIMAL               
                                        
: DECOMPILER  ;                         
                                        
 VARIABLE LMAX                          
 VARIABLE NLINES      14 NLINES !       
 VARIABLE BUFPNTR                       
 VARIABLE NMAX:       10 NMAX: !        
 VARIABLE SAVETODISK   0 SAVETODISK !   
 VARIABLE 1STSCR       0 1STSCR !       
 VARIABLE DISKFLAG     0 DISKFLAG !     
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 057
( BLANK SCREEN          << 7/20/83>197) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 058
( DECOMPILER            << 5/ 2/85>198) 
                                        
( CHAR ---, )                           
: DISKEMIT                              
   DUP 10 -                             
   IF DUP 13 -                          
      IF 127 AND DUP 32 <               
         IF 94 BUFPNTR @ C! 1           
            BUFPNTR +! 64 +             
         THEN                           
         BUFPNTR @ C! 1 BUFPNTR +!      
      ELSE DROP LCOUNT @ 1- SCR @       
         <LINE> DROP BUFPNTR !          
      THEN                              
   ELSE DROP THEN ;                     
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 059
( BLANK                 << 7/20/83>199) 
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 060
( DECOMPILER            << 5/ 2/85>200) 
                                        
( CHAR ---, )                           
: <DISK-EMIT>                           
   DISKFLAG @                           
   IF DUP DISKEMIT THEN                 
   <EMIT> ;                             
                                        
: CR2 13 EMIT ;                         
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 061
( BLANK SCREEN          << 7/20/83>201) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 062
( DECOMPILER            << 5/ 2/85>202) 
                                        
: DISKON                                
   ' <DISK-EMIT> CFA ' EMIT !           
   1 DISKFLAG ! FLUSH ;                 
                                        
: DISKOFF                               
   ' <EMIT> CFA ' EMIT !                
   0 DISKFLAG ! 0 SAVETODISK ! ;        
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 063
( DECOMPILER            << 5/ 2/85>203) 
                                        
: NEWSCREEN                             
   USE @ >R PREV @ >R SCR @             
   OFFSET @ + BUFFER DUP BUFPNTR !      
   1024 BL FILL UPDATE R> PREV !        
   R> USE ! ;                           
                                        
: PRINTSCR                              
   NEWSCREEN ."                         
   ( SCR NO. "  SCR @ .  ." )"          
   2 LCOUNT !                           
   CR2 0 OUT ! ;                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 064
( DECOMPILER            << 5/ 2/85>204) 
: DISK?                                 
   SAVETODISK @                         
   IF LCOUNT @ LMAX @ >                 
      IF 1 LCOUNT +! CR2 ." -->"        
         1 SCR +! PRINTSCR              
      THEN                              
   THEN ;                               
                                        
: NEXTL                                 
   DISK? 1 LCOUNT +! CR2 0 OUT !        
   MARGIN @ MARGINADJ @ + SPACES 0      
   MARGINADJ ! ;                        
                                        
( COUNT ---, )                          
: ENDL?                                 
   OUT @ + LLENGTH @ >                  
   IF NEXTL THEN ;                      
                                        
-->                                     
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 065
( DECOMPILER            << 5/ 2/85>205) 
                                        
( CFA ---, )                            
: PRID                                  
   2+ NFA DUP C@ 31 AND ENDL? ID. ;     
                                        
: IMMD?                                 
   NFA C@ 64 AND                        
   IF 13 ENDL? ."   IMMEDIATE"          
   THEN ;                               
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 066
( DECOMPILER             <12/21/85>206) 
                                        
: DISKWRITE?                            
   SAVETODISK @                         
   IF 2BELLS CR CR                      
      ." WRITES ON DISK" CR             
      ." FIRST SCR NO. " 1STSCR @ . CR  
      CR ." DO YOU MEAN IT (Y/N)? "     
      ?TERMINAL DROP          ( rlp)    
      KEY 89 = 0=                       
      IF DISKOFF QUIT THEN              
      1STSCR @ SCR !          ( rlp)    
   THEN                                 
   HOME                                 
   NLINES @ LMAX !                      
   SAVETODISK @                         
   IF DISKON THEN ;                     
                                        
-->                                     
                                        
                                        
                                        
                                        
                               (  PAI ) 
-------------------------------------------- SCREEN 067
( DECOMPILER            << 5/ 2/85>207) 
                                        
 0 CONSTANT +LADJ                       
                                        
: TST 0 1 2 DO DROP I -1 +LOOP ;        
                                        
TST ' +LADJ !                           
FORGET TST                              
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 068
( DECOMPILER            << 5/ 2/85>208) 
                                        
: SPACEA PAD ;                          
: ENDA   FIRST 700 - 0                  
         PAD 0 DMAX DROP ;              
: SPACEB ENDA  2+ ;                     
: ENDB   FIRST 2- ;                     
                                        
: FIN                                   
   SAVETODISK @                         
   IF CR2 ." EXIT" DISKOFF FLUSH        
      HOME ." SAVED ON SCRNS "          
      1STSCR @ . ." THRU " SCR @ .      
   THEN                                 
   2BELLS CR CR ." FINISHED" CR         
   0 SAVETODISK ! ;                     
-->                                     
                                        
 0 CONSTANT SPACEA 0 CONSTANT ENDA      
 0 CONSTANT SPACEB 0 CONSTANT ENDB      
                                        
                                        
                                        
                                        
-------------------------------------------- SCREEN 069
( DECOMPILER             <12/21/85>209) 
( ---, N < A NON-NEG NUMBER> )          
: INNUMB                                
   BEGIN                                
      ?TERMINAL DROP             ( rlp) 
      HERE DUP 30 EXPECT @ 0=           
      IF ." ? REPEAT" CR 0              
      ELSE HERE C@ DUP 47 > SWAP        
         58 < AND                       
         IF 0 0 HERE 1- CONVERT         
            DDROP 1                     
         ELSE ." ? REPEAT" CR 0         
         THEN                           
      THEN                              
   UNTIL ;                              
                                        
: SAVESOURCE                            
   CR CR ." START SCREEN NO. = " CR     
   INNUMB 1STSCR ! 1 SAVETODISK ! ;     
-->                                     
                                        
                                        
                                        
                               (  PAI ) 
-------------------------------------------- SCREEN 070
( DECOMPILER            << 5/ 2/85>210) 
                                        
VARIABLE AEND                           
VARIABLE INDENT  3 INDENT !             
VARIABLE HILITE  1 HILITE !             
                                        
( ADDR ---, ADDR )                      
: SPACEAMAX?                            
   ENDA OVER U<                         
   IF DISKOFF                           
      CR ." SPACEA TOO SMALL"           
      2BELLS QUIT                       
   THEN ;                               
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 071
( DECOMPILER            << 5/ 2/85>211) 
                                        
: BE-  ;    ' BE- CFA CONSTANT BEG      
: WH-  ;    ' WH- CFA CONSTANT WHIL     
: RE-  ;    ' RE- CFA CONSTANT RPT      
: UN-  ;    ' UN- CFA CONSTANT UNTL     
: AG-  ;    ' AG- CFA CONSTANT AGN      
: IF-  ;    ' IF- CFA CONSTANT IFF      
: EL-  ;    ' EL- CFA CONSTANT ELS      
: TH-  ;    ' TH- CFA CONSTANT THN      
           ' <DO> CFA CONSTANT DOO      
                                        
0 CONSTANT NULLCFA                      
' NULLCFA DUP CFA SWAP !                
                                        
( PFA ---, )                            
: MOVEPF                                
   ENDOFPF @ OVER - DUP SPACEA          
   2+ + SPACEAMAX? ENDCOLON OVER 2- !   
   AEND ! SPACEA SWAP CMOVE ;           
-->                                     
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 072
( DECOMPILER            << 5/ 2/85>212) 
                                        
( CFA? N<J>PF<I> ---, CFA? N<K>PF<J> F) 
: FINDCFA                               
   ADDEXIT 0                            
   BEGIN                                
      DROP COLON-CALL                   
      COMPILEAFTER @ 0=                 
      IF SWAP 5 PICK = SWAP OVER OR     
      ELSE SWAP DROP 0 SWAP             
      THEN                              
      COMPILENEXT @ COMPILEAFTER !      
      AEND @ 4 PICK U<                  
      OR                                
   UNTIL ;                              
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 073
( DECOMPILER            << 5/ 2/85>213) 
                                        
: SPACEBMOVE ( addr count -- )          
   SPACEB OVER + ENDB U< NOT            
   IF DISKOFF                           
      CR CR ." SPACEB TOO SMALL"        
      2BELLS QUIT                       
   THEN                                 
   SPACEB SWAP CMOVE ;                  
                                        
( CFA? N<J> PF<I> ---, CFA? 2 PF<I+2>)  
: INSRTBEG                              
   SWAP DROP 2 SWAP DUP 2+ @            
   NEGATE 2- DDUP -                     
   DDUP SWAP SPACEBMOVE                 
   ( DUP SPACEB 4 PICK CMOVE )          
   BEG OVER !                           
   SPACEB SWAP 2+ 3 ROLL CMOVE 2+ ;     
-->                                     
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 074
( DECOMPILER            << 5/ 2/85>214) 
                                        
: BEGUNTL?                              
   0BRA 0 SPACEA                        
   BEGIN                                
      FINDCFA                           
   WHILE                                
      DUP 2+ @ 0<                       
      IF INSRTBEG UNTL OVER ! THEN      
   REPEAT                               
   DDROP DROP ;                         
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 075
( BLANK SCREEN          << 7/20/83>215) 
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 076
( DECOMPILER            << 5/ 2/85>216) 
                                        
( CFA<BR> 2 PF<I+2> ---, SAME )         
: INSRTRPT/AGN                          
   0BRA 2 3 PICK DUP @ +                
   ENDCOLON 5 PICK !                    
   BEGIN                                
      FINDCFA                           
      IF DUP DUP 2+ @ + 5 PICK 2+ =     
         IF RPT 5 PICK ! WHIL OVER !    
            2+ NULLCFA SWAP ! DDROP     
            1                           
         ELSE 0 THEN                    
      ELSE DDROP DROP AGN OVER ! 1      
      THEN                              
   UNTIL ;                              
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 077
( DECOMPILER            << 5/ 2/85>217) 
                                        
: BEGRPT/AGN?                           
   BRA 0 SPACEA                         
   BEGIN                                
      FINDCFA                           
   WHILE                                
      DUP 2+ @ 0<                       
      IF INSRTBEG INSRTRPT/AGN THEN     
   REPEAT                               
   DDROP DROP ;                         
                                        
( CFA<0BR> N<J> PF<J> ---, SAME )       
: INSRTIFTHN                            
   IFF OVER ! SWAP DROP 2               
   SWAP DUP 2+ @ OVER 4 + DUP 2-        
   3 PICK 2- CMOVE OVER + THN SWAP ! ;  
-->                                     
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 078
( DECOMPILER            << 5/ 2/85>218) 
( CFA<0BR> N<I> PF<I> ---, SAME )       
: INSRTIFELS                            
   IFF OVER ! SWAP DROP 2               
   SWAP DUP 2+ @ DUP 3 PICK OVER + @ +  
   2- 3 PICK 4 + DUP 2- 3 PICK 2-       
   CMOVE 3 PICK + THN SWAP ! OVER +     
   4 - ELS OVER ! NULLCFA SWAP 2+ ! ;   
                                        
: IFELSTHN?                             
   0BRA 0 SPACEA                        
   BEGIN                                
      FINDCFA                           
   WHILE                                
      DUP 2+ @ OVER + 2- @ BRA =        
      IF INSRTIFELS                     
      ELSE INSRTIFTHN                   
      THEN                              
   REPEAT                               
   DDROP DROP ;                         
                                        
EXIT                                    
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 079
( DECOMPILER            << 7/20/83>219) 
                                        
( CFA-BRA/0BRA ---, )                   
: ADJREL  0 SPACEA                      
   BEGIN FINDCFA                        
   WHILE DUP 2+ DUP @ OVER SPACEA -     
    WORDTEST @ + - SWAP !               
   REPEAT DDROP DROP ;                  
                                        
: MAKEREL  0BRA ADJREL BRA ADJREL ;     
                                        
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 080
( DECOMPILER            << 7/20/83>220) 
                                        
: MAKEREL ;                             
                                        
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 081
( MADEDOESABS           << 7/20/83>221) 
                                        
: MAKEDOESABS  ABSDOESJMP 0=            
   IF -1 ' ABSDOESJMP ! COLONCODE 0     
    SPACEA                              
     BEGIN FINDCFA                      
     WHILE DUP DJB + 2+ DUP DUP @ + 2+  
      WORDTEST @ SPACEA - + SWAP !      
     REPEAT DDROP DROP                  
   THEN ;                               
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 082
( DECOMPILER            << 7/20/83>222) 
                                        
: NEWLINE  DISK? 1 LCOUNT +! CR2 0 OUT  
   ! ;                                  
                                        
: PARA  INDENT @ MARGIN +! HILITE @     
   NEGATE MARGINADJ ! NEXTL ;           
                                        
: STANDOUT  HILITE @ NEGATE MARGINADJ ! 
   NEXTL ;                              
                                        
: ENDPARA  HILITE @ NEGATE MARGINADJ !  
   NEXTL INDENT @ NEGATE MARGIN +! ;    
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 083
( DECOMPILER            << 7/20/83>223) 
                                        
( PF<I> CFA ---, PF<I> )                
: QUOTE  DROP DUP 3 + DUP 1- C@ DUP     
   5 + ENDL?                            
     BEGIN DUP 0 >                      
     WHILE LLENGTH @ OUT @ - 5 - OVER   
      MIN 46 EMIT 34 EMIT SPACE DUP 4   
      PICK SWAP TYPE 34 EMIT SPACE DUP  
      4 ROLL + ROT ROT - DUP 5 + ENDL?  
     REPEAT DDROP ;                     
                                        
( PF<I> CFA ---, PF<I> )                
: ABQUOTE DROP DUP 3 + DUP 1- C@ DUP 9  
   + ENDL? ." ABORT" 34 EMIT SPACE TYPE 
   34 EMIT SPACE ; -->                  
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 084
( DECOMPILER            << 7/20/83>224) 
                                        
( PF<I> CFA ---, PF<I> <0>OR<PFA 1> )   
: SLOGIC?  DUP DOO =                    
     IF PARA ." DO " DROP 0             
     ELSE DUP BEG =                     
        IF PARA ." BEGIN " DROP 0       
        ELSE DUP IFF =                  
           IF PARA ." IF " DROP 0       
           ELSE 1                       
           THEN                         
        THEN                            
     THEN ;                             
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 085
( DECOMPILER            << 7/20/83>225) 
                                        
( SAME AS SLOGIC? )                     
: MLOGIC?                               
     IF DUP WHIL =                      
        IF STANDOUT ." WHILE " DROP 0   
        ELSE DUP ELS =                  
           IF STANDOUT ." ELSE " DROP   
            0                           
           ELSE 1                       
           THEN                         
        THEN                            
     ELSE 0                             
     THEN ;                             
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 086
( BLANK SCREEN          << 7/20/83>226) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 087
( DECOMPILER            << 7/20/83>227) 
                                        
( SAME AS SLOGIC? )                     
: ELOGIC?                               
     IF DUP RPT =                       
        IF ENDPARA ." REPEAT " DROP 0   
        ELSE DUP UNTL =                 
           IF ENDPARA ." UNTIL " DROP 0 
           ELSE DUP AGN =               
              IF ENDPARA ." AGAIN "     
               DROP 0                   
              ELSE DUP THN =            
                 IF ENDPARA ." THEN "   
                  DROP 0                
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 088
( DECOMPILER            << 7/20/83>228) 
                                        
                 ELSE DUP <LOO =        
                    IF ENDPARA          
                     ." LOOP " DROP 0   
                    ELSE DUP <+LOO =    
                       IF ENDPARA       
                        ." +LOOP "      
                        DROP 0          
                       ELSE DUP </LOO = 
                        IF ENDPARA      
                      ." /LOOP " DROP 0 
                       ELSE 1           
      THEN THEN THEN THEN THEN THEN THEN
     ELSE 0                             
     THEN ;       -->                   
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 089
( DECOMPILER            << 7/20/83>229) 
                                        
VARIABLE DECOM  VARIABLE LFUP 0 DECOM ! 
                                        
( PF<I> CFA ---, PF<I> )                
: OTHER?                                
     IF DUP COLONCODE =                 
        IF ENDTYPE @ 3 =                
           IF DROP 6 ENDLINE? ." DOES> "
           THEN                         
        ELSE DUP WORDTEST @ CFA =       
           IF DROP 7 ENDL? ." MYSELF "  
           ELSE PRID                    
           THEN                         
        THEN                            
     THEN ; -->                         
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 090
( DECOMPILER            << 7/20/83>230) 
                                        
( PF<I> ---, PF<I> )                    
: PRINTSOURCE  DUP @ DUP <." =          
     IF QUOTE                           
     ELSE DUP <AB" =                    
        IF ABQUOTE                      
        ELSE DUP LITT =                 
           IF DROP DUP 2+ @ 6 ENDL?     
            12000 OVER ABS <            
            IF U. ELSE . THEN           
           ELSE SLOGIC? MLOGIC?         
            ELOGIC? OTHER?              
     THEN THEN THEN ;    -->            
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 091
( BLANK SCREEN          << 7/20/83>231) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 092
( DECOMPILER            << 5/ 2/85>232) 
( PF<I> ---, )                          
: CONVERTTOSOURCE                       
   0 COMPILENEXT !                      
   0 COMPILEAFTER !                     
   0 ADDEXIT                            
   BEGIN                                
      COLON-CALL 0= 3 PICK AEND @       
      U< AND                            
   WHILE                                
      DUP NULLCFA = 0=                  
      IF 2+ NFA C@ 64 AND               
         IF 10 ENDL? ." [COMPILE] "     
            DUP @ PRID                  
         ELSE COMPILEAFTER @            
            IF DUP @ PRID               
            ELSE PRINTSOURCE            
         THEN THEN                      
      ELSE DROP THEN                    
      COMPILENEXT @                     
      COMPILEAFTER !                    
   REPEAT                               
-->                                     
                               (  RLP ) 
-------------------------------------------- SCREEN 093
( DECOMPILER            << 5/ 2/85>233) 
                                        
   DUP ENDCOLON =                       
   IF DROP 1 ENDL? ." ;"                
   ELSE COLONCODE =                     
      IF 5 ENDL? ." ;CODE"              
      THEN                              
   THEN DDROP ;                         
                                        
: ENDTEST                               
   LFUP @ ENDOFPF @ U<                  
   IF LFUP @ UPLIM @ 2- U<              
      IF ." ( THIS WORD HAS "           
         ." NO ENDING ; )"              
         NEWLINE LFUP @ ENDOFPF !       
         BELL                           
   THEN THEN ;                          
-->                                     
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 094
( DECOMPILER            << 5/ 2/85>234) 
                                        
( PFA ---, PFA )                        
: NF&PF                                 
   DECOM @                              
   IF DUP DUP 8 SPACES                  
      ." ( NFA&PFA: " NFA U. U. ." )"   
      NEWLINE                           
   THEN ;                               
                                        
( PFA ---, )                            
: PFBYTES?                              
   DECOM @                              
   IF LFUP @ DUP ROT - .                
      ." BYTE<S> IN PF "                
      ENDOFPF !                         
   ELSE DROP THEN ;                     
                                        
-->                                     
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 095
( DECOMPILER            << 5/ 2/85>235) 
                                        
( PFA ---, )                            
: OTHCODE                               
   NEWLINE NF&PF DUP ." ( "             
   NFA ID. ."  OTHER "                  
   PFBYTES? ." )" ;                     
                                        
( PFA ---, )                            
: DUZCODE                               
   NEWLINE NF&PF                        
   ." ( DOES ARGUMENT? )  " DUP CFA @   
   NFAABOVE 2- @ 2+ PFA CFA PRID        
   SPACE DUP CFA PRID NEWLINE DECOM @   
   IF ." ( " PFBYTES? ." )"             
   ELSE DROP                            
   THEN ;                               
-->                                     
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 096
( BLANK SCREEN          << 7/20/83>236) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 097
( DECOMPILER            << 5/ 2/85>237) 
                                        
( PFA ---, )                            
: CONCODE                               
   NEWLINE NF&PF DUP @ 6 .R             
   ."  CONSTANT " DUP 2+ ENDOFPF !      
   NFA ID. ;                            
                                        
( PFA ---, )                            
: VARCODE                               
   NEWLINE NF&PF DUP @                  
   ."   ( "   6 .R   ." ) VARIABLE "    
   DUP 2+ ENDOFPF !                     
   NFA ID. ;                            
                                        
( PFA ---, )                            
: ASSCODE                               
   NEWLINE NF&PF DUP ." ( "             
   NFA ID. ."  CODE " PFBYTES? ." )" ;  
-->                                     
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 098
( DECOMPILER            << 5/ 2/85>238) 
                                        
( PFA ---, )                            
: COLCODE                               
   DUP ENDOFPF+ NMAX: @ LMAX !          
   NEWLINE NLINES @ LMAX ! NF&PF        
   DECOM @                              
   IF ENDTEST THEN                      
   ." : " DUP NFA ID. SPACE             
   MOVEPF MAKEREL MAKEDOESABS BEGUNTL?  
   BEGRPT/AGN? IFELSTHN? SPACEA         
   CONVERTTOSOURCE ABSDOESJMP 0<        
   IF 0 ' ABSDOESJMP ! THEN             
   DECOM @                              
   IF ENDTYPE @ 2 =                     
      IF NEWLINE ." ( PLUS "            
         LFUP @ DUP ENDOFPF @ - .       
         ." BYTES OF CODE )"            
         ENDOFPF !                      
   THEN THEN ;                          
-->                                     
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 099
( DECOMPILER            << 5/ 2/85>239) 
                                        
( PFA ---, <NEEDS WORDB HI LIMIT> )     
: DECODEWORD                            
   FIRSTINDENT @ MARGIN ! 0 OUT !       
   DUP DUP CFA @                        
   DDUP =         IF DROP ASSCODE ELSE  
   DUP COLON =    IF DROP COLCODE ELSE  
   DUP VARIABL =  IF DROP VARCODE ELSE  
   DUP CONSTNT =  IF DROP CONCODE ELSE  
   DJB + DOESCODE? IF     DUZCODE ELSE  
                          OTHCODE       
   THEN THEN THEN THEN THEN             
   IMMD? NEWLINE DISK? ;                
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 100
( BLANK SCREEN          << 7/20/83>240) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 101
( DECOMPILER  SPACEA&B  <<12/20/85>241) 
                                        
( HERE ' SPACEA ! 800 ALLOT )           
( HERE ' ENDA !             )           
( HERE ' SPACEB ! 700 ALLOT )           
( HERE ' ENDB !             )           
                                        
: CLEARWORKSPACE                        
   SPACEA ENDA OVER - 0 FILL            
   SPACEB ENDB OVER - 0 FILL            
   ;                                    
                                        
( CLEARWORKSPACE )                      
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               (  PAI ) 
-------------------------------------------- SCREEN 102
( DECOMPILER            << 5/ 2/85>242) 
                                        
( BEGSPACE ENDSPACE ---, )              
: BYTESUSED                             
   DUP 3 PICK - . ." BYTES, "           
   OVER +LADJ - OVER 1-                 
   DO DROP I DUP C@ ( 0= 0= )           
      IF LEAVE THEN                     
      -1                                
   +LOOP                                
   SWAP - 1+ . ." USED." CR ;           
                                        
: WORKSPACE?                            
   CR CR                                
   ." SPACEA: " SPACEA ENDA BYTESUSED   
   ." SPACEB: " SPACEB ENDB BYTESUSED   
   ;                                    
-->                                     
                                        
                                        
                                        
                                        
                                        
                               (  RLP ) 
-------------------------------------------- SCREEN 103
( DECOMPILE <>OR WORD<S><< 5/ 2/85>243) 
                                        
: DECOMPILE                             
   WORDSAB NOWORDS? SETUPLIM            
   WORDA @ WORDTEST ! 1 DECOM !         
   DISKWRITE? SAVETODISK @              
   IF PRINTSCR THEN                     
   BEGIN                                
      WORDTEST @ DUP NFAABOVE           
      2- LFUP ! DECODEWORD WORDTEST @   
      WORDB @ U< CONT/QUIT? 0= AND      
   WHILE                                
      LFUP @ DUP 2+ PFA WORDTEST !      
      ENDOFPF @ - DUP 0=                
      IF DROP                           
      ELSE                              
         NEXTL . ." ALLOT  ( AT "       
         ENDOFPF @ U. ."  )"            
         NEWLINE                        
      THEN                              
   REPEAT FIN ;                         
                                        
EXIT                                    
                               (  RLP ) 
-------------------------------------------- SCREEN 104
( SUBRDECOMPILER        << 7/20/83>244) 
FORTH DEFINITIONS DECIMAL               
                                        
: SUBRDECOMPILER  ;                     
       VARIABLE CFEND                   
       VARIABLE TERMEND                 
       VARIABLE LEVELS                  
     0 CONSTANT SPACEX                  
     0 CONSTANT ENDX                    
     0 CONSTANT SPACEY                  
     0 CONSTANT ENDY                    
       VARIABLE PFACOUNT                
       VARIABLE LEVEL                   
       VARIABLE PFEND                   
       VARIABLE CFMARK                  
       VARIABLE TERMMARK   -->          
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 105
( BLANK SCREEN          << 7/20/83>245) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 106
( SUBRDECOMPILER        << 7/20/83>246) 
                                        
: SPACEXMAX?  ENDX CFEND @ U<           
     IF DISKOFF CR                      
      ." SPACEX TOO SMALL" 2BELLS QUIT  
     THEN ;                             
                                        
: SPACEYMAX?  ENDY TERMEND @ U<         
     IF DISKOFF CR                      
      ." SPACEY TOO SMALL" 2BELLS QUIT  
     THEN ;                             
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 107
( SUBRDECOMPILER        << 7/20/83>247) 
                                        
: SUBSORCHEAD  WORDSAB DUP NOWORDS? 1 = 
     IF DISKOFF 7 EMIT CR               
      ." NEED LOWER LIMIT" QUIT         
     THEN WORDB @ CFA SPACEX ! 1        
   PFACOUNT ! SPACEX CFMARK ! SPACEY    
   TERMMARK ! SPACEY TERMEND ! SPACEA   
   PFEND ! SPACEX 2+ CFEND ! HOME       
   ." GETTING CALLS FROM: " WORDB @ NFA 
   ID. CR CR ." DOWN THRU: " WORDA @ NFA
   ID. CR CR WORDB @ CFA @ COLON = 0=   
     IF DISKOFF 2BELLS                  
      ." NOT A COLON SUBROUTINE" CR QUIT
     THEN CR CR ." DOING LEVEL: " ;     
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 108
( SUBRDECOMPILER        << 7/20/83>248) 
                                        
: MOVEXTOA  CFMARK @ SPACEA CFEND @ 3   
   PICK - 2/ DUP PFACOUNT ! 0           
     DO OVER @ 2+ OVER !                
        2+ SWAP 2+ SWAP                 
     LOOP DDROP                         
   1 LEVELS +!                          
   LEVELS @ . ;                         
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
-------------------------------------------- SCREEN 109
( SUBRDECOMPILER        << 5/ 9/85>249) 
: SORTCF/TERM                           
   CFEND @ CFMARK !                     
   TERMEND @ TERMMARK ! SPACEA          
   PFACOUNT @ 0                         
   DO DUP @ DUP WORDTEST ! 0 ADDEXIT    
      BEGIN                             
         COLON-CALL 0=                  
      WHILE                             
         DUP WORDA @ CFA U<             
            IF DROP                     
            ELSE                        
         DUP 5 PICK @ CFA =             
            IF DROP                     
            ELSE                        
         DUP @ COLON =                  
            IF CFEND @ ! 2 CFEND +!     
            ELSE                        
-->                                     
                                        
                                        
                                        
                                        
                               ( WHO? ) 
-------------------------------------------- SCREEN 110
( SUBRDECOMPILER        << 5/ 9/85>250) 
                                        
         DUP TERMEND @ !                
          2 TERMEND +! @ DJB +          
           DUP DOESCODE?                
            IF NFAABOVE 2- @            
               2+ PFA CFA CFEND @ !     
               2 CFEND +!               
               DOES CFEND @ !           
               2 CFEND +!               
            ELSE DROP                   
         THEN THEN THEN THEN            
      REPEAT                            
      DDROP DROP 2+                     
   LOOP                                 
   SPACEAMAX? DROP                      
   SPACEXMAX? SPACEYMAX? ;              
-->                                     
                                        
                                        
                                        
                                        
                                        
                               ( WHO? ) 
-------------------------------------------- SCREEN 111
( BLANK SCREEN          << 7/20/83>251) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 112
( PRID SHORT VERSION    << 7/20/83>252) 
( : PRID 2+ NFA ID. CR ; )              
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 113
( SUBRDECOMPILER        << 7/20/83>253) 
                                        
( END MARK START ---, END' )            
: DELETEDUPL                            
   BEGIN DUP 2+ 4 PICK <                
   WHILE DUP @ 4 PICK 4 PICK 4 PICK 2+  
    MAX                                 
    DO I @ OVER =                       
     IF I 2+ I 6 PICK 3 PICK - CMOVE    
      4 ROLL 2- 4 ROLL 4 ROLL 4 ROLL    
      R> 2- R> 2- >R >R                 
     THEN 2                             
    +LOOP DROP 2+                       
   REPEAT DDROP ;                       
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 114
( SUBRDECOMPILER        << 7/20/83>254) 
                                        
( AS AE ---, )                          
: PRINTSUBSOURCE                        
     BEGIN 2- DUP 3 PICK U< 0=          
      CONT/QUIT? 0= AND                 
     WHILE DUP @ 2+ DUP WORDTEST !      
      DECODEWORD                        
     REPEAT DDROP ;                     
                                        
( AS AI ---, )                          
: PRINTSUBIDS  DUP ROT - 2/ DUP         
   ." (" . ." WORDS)" CR CR 0 OUT !     
   MARGIN @ SPACES 0                    
     DO 2- DUP @ PRID                   
     LOOP DROP ;  -->                   
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 115
( SUBRDECOMPILER        << 7/20/83>255) 
                                        
: SHELLSORT DDUP - 2/ 1+ DUP            
   BEGIN DUP 1 >                        
    WHILE 2/                            
     BEGIN 0 3 PICK 3 PICK - 0          
      DO I DUP + 5 PICK + DUP 4 PICK DUP
       + + OVER @ OVER @ DDUP U<        
       IF 4 ROLL ! SWAP ! 1+            
       ELSE DDROP DDROP                 
       THEN                             
      LOOP 0=                           
     UNTIL                              
    REPEAT DDROP DDROP ;                
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 116
( SUBRDECOMPILER        << 7/20/83>256) 
                                        
: SORTCFAS  CR CR ." ORDERING WORDS"    
   TERMEND @ 2- SPACEY SHELLSORT CFEND  
   @ 2- SPACEX SHELLSORT ;              
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 117
( SUBRDECOMPILER        << 7/20/83>257) 
                                        
( -- WORD SEARCHLIMIT , )               
: GETSUBRWORDS  SUBSORCHEAD 0 LEVELS !  
   SETUPLIM                             
     BEGIN CFMARK @ CFEND @ -           
     WHILE MOVEXTOA SORTCF/TERM CFMARK  
      @ CFEND @ -                       
        IF CFEND @ CFMARK @ SPACEX      
         DELETEDUPL CFEND !             
        THEN TERMMARK @ TERMEND @ -     
        IF TERMEND @ TERMMARK @ SPACEY  
         DELETEDUPL TERMEND !           
        THEN                            
     REPEAT SORTCFAS FIN ;              
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 118
( BLANK SCREEN          << 7/20/83>258) 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 119
( SUBRDECOMPILER SPACEXY<< 7/20/83>259) 
                                        
HERE ' SPACEX ! 800 ALLOT               
HERE ' ENDX !                           
HERE ' SPACEY ! 2000 ALLOT              
HERE ' ENDY !                           
                                        
: CLEARWORKSPACE CLEARWORKSPACE         
   SPACEX ENDY OVER - 0 FILL ;          
                                        
: WORKSPACE? WORKSPACE? ." SPACEX: "    
   SPACEX ENDX BYTESUSED ." SPACEY: "   
   SPACEY ENDY BYTESUSED ;              
                                        
CLEARWORKSPACE                          
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 120
( SUBRDECOMPILER        << 7/20/83>260) 
                                        
( ---, <USE AFTER GETSUBRWORDS> )       
: SUBRDECOMPILE  DISKWRITE? 0 DECOM !   
   SAVETODISK @                         
     IF PRINTSCR                        
     THEN SPACEY TERMEND @              
   PRINTSUBSOURCE SPACEX CFEND @        
   PRINTSUBSOURCE FIN ;                 
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 121
( SUBRDECOMPILER        << 7/20/83>261) 
                                        
( ---, <USE AFTER GETSUBRWORDS> )       
: SUBRCALLS  DISKOFF SPACEY TERMEND @   
   HOME CR CR ." NON-COLON WORDS:"      
   CR CR DDUP -                         
     IF PRINTSUBIDS THEN                
     SPACEX CFEND @ CR CR               
   ." COLON WORDS:" CR CR PRINTSUBIDS   
   CR CR LEVELS @ .                     
   ." LEVELS OF NESTING" FIN ;          
                                        
  EXIT                                  
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 122
( ASCOMPILED            << 7/20/83>262) 
                                        
( ---, <SAME AS SUBRCALLS, EXCEPT    )  
( LISTS ALL WORDS TOGETHER IN SAME   )  
( SEQUENCE AS COMPILED.>             )  
: ASCOMPILED  CR CR DISKOFF             
   ." ALL WORDS IN COMPILED SEQUENCE:"  
   CR CR 0 OUT ! MARGIN @ SPACES        
   CFEND @ DUP 2- CFMARK !              
   TERMEND @ DUP 2- TERMMARK !          
   SPACEY - SWAP SPACEX - + 2/ 0        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 123
( ASCOMPILED            << 7/20/83>263) 
                                        
   DO CFMARK @ SPACEX OVER 1+ U<        
    IF @ TERMMARK @ SPACEY OVER 1+ U<   
     IF @ DDUP U<                       
      IF DROP -2 CFMARK +!              
      ELSE SWAP DROP -2 TERMMARK +!     
      THEN                              
     ELSE DROP -2 CFMARK +!             
     THEN                               
    ELSE DROP TERMMARK @ @              
     -2 TERMMARK +!                     
    THEN PRID                           
   LOOP CR CR ;                         
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 124
( DO EXIT'S TEST        << 7/20/83>264) 
                                        
LOADTRANSLATOR                          
                                        
ADDCALLFINDER ADDDECOMPILER             
                                        
115 +FPA0 LOAD                          
                                        
DOEXITTEST                              
                                        
FORGET NONCFA?  EXIT                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 125
( DO EXIT'S TEST        << 7/20/83>265) 
                                        
( CFA ---, F )  ( F=1 IF NOT A CFA )    
: NONCFA?   2- 0 20 0                   
   DO DROP DUP 1STPFA LFA U<            
    ' NULL 3 PICK U< OR                 
    IF 1 LEAVE                          
    ELSE DUP 4 + 1STPFA =               
     IF 0 LEAVE                         
     ELSE DUP @ PFA LFA SWAP OVER U<    
      IF 1 LEAVE                        
      ELSE 0                            
    THEN THEN THEN                      
   LOOP SWAP DROP ;                     
                                        
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 126
( DO EXIT'S TEST        << 7/20/83>266) 
                                        
: MSG3                                  
   ." REPLACE THE SAMPLE TABLE ON SC"   
   ." R 12+FPA0" CR                     
   ." WITH ABOVE AND START OVER." CR    
   ." ALSO, SET HASTERMINATORS ON S"    
   ." CR 0+FPA0" CR                     
   ." TO THE VALUE ZERO." CR ;          
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 127
( DO EXIT'S TEST        << 7/20/83>267) 
                                        
: MAKETABLE  0 WORDTEST @               
   BEGIN COLON-CALL DDROP DDUP +        
    @ NONCFA?                           
   UNTIL SWAP DROP DUP @ BRA =          
   IF 2+ THEN 2+ WORDTEST @ - CR 6 .R   
   ."  STOREBYTES  " WORDTEST @         
   NFA ID. ;                            
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 128
( DO EXIT'S TEST        << 7/20/83>268) 
                                        
: TESTCOLEND  WORDTEST @ ENDOFPF+       
   ENDTYPE @ 2 = 0=                     
    IF LFUP @ ENDOFPF @ U<              
     IF LFUP @ UPLIM @ U<               
      IF MAKETABLE 0 ' HASTERMINATORS ! 
      THEN                              
     THEN                               
    THEN ;                              
                                        
: MSG1                                  
   ." ALL COLON WORDS END WITH EXIT "   
   ." OR ARE" CR ." IN THE TABLE." CR   
   CR ." YOU CAN NOW ADDSUBRDECOMPILER" 
   CR ." FOR THE TOTAL FPA." CR ; -->   
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 129
( DO ;STEST             << 7/20/83>269) 
                                        
: MSG2                                  
   ." THE LOOK-UP TABLE ON SCRN 12+F"   
   ." PA0" CR ." IS IN ERROR." CR       
   ." CORRECT THE TABLE WITH THE ABO"   
   ." VE." CR ." AND START OVER."       
   CR ;                                 
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 130
( DO ;S TEST            << 7/20/83>270) 
                                        
: PRINTCONCL  CR CR MISC @              
   IF HASTERMINATORS                    
      IF MSG1                           
      ELSE MSG3 122 +FPA0 LOAD          
      THEN                              
   ELSE HASTERMINATORS                  
      IF MSG1                           
      ELSE MSG2 122 +FPA0 LOAD          
      THEN                              
   THEN ;                               
-->                                     
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 131
( DO EXIT'S TEST        << 7/20/83>271) 
                                        
: DOEXITTEST  CR CR CR 1STPFA WORDA !   
   ." TESTING ENDING EXIT'S" CR         
   HASTERMINATORS MISC !                
   1 ' HASTERMINATORS ! ' NULL          
   DUP NFA DUP UPLIM ! 2+ LFUP !        
   WORDTEST !                           
   BEGIN WORDTEST @ CFA @ COLON =       
    IF TESTCOLEND  THEN                 
    WORDA @ WORDTEST @ U<               
   WHILE WORDTEST @ DUP LFA LFUP !      
    LFA @ 2+ PFA WORDTEST !             
   REPEAT PRINTCONCL ;                  
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 132
( FORGET TRANSLATOR     << 7/20/83>272) 
                                        
CR ." FORGETTING TRANSLATOR" CR         
                                        
FORGET TRANSLATOR                       
                                        
QUIT                                    
                                        
EXIT                                    
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 133
(                       << 7/20/83>273) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 134
(                        < 7/20/83>274) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 135
(                        < 7/20/83>275) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 136
(                        < 7/20/83>276) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 137
(                        < 7/20/83>277) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 138
(                        < 7/20/83>278) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
-------------------------------------------- SCREEN 139
(                        < 7/20/83>279) 
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                               ( 10:12) 
